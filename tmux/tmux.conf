# Sema-themed tmux configuration
# Optimized for macOS with focus on complexity-aware visual design

# =============================================================================
# GENERAL SETTINGS
# =============================================================================

# Use 256 colors
set -g default-terminal "screen-256color"
set-option -sa terminal-overrides ',xterm-256color:RGB'

# Set scrollback buffer size
set -g history-limit 10000

# Start windows and panes at 1, not 0 (more intuitive)
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed
set -g renumber-windows on

# Faster key repetition
set -s escape-time 0

# Enable mouse support
set -g mouse on

# =============================================================================
# KEY BINDINGS
# =============================================================================

# Change prefix from Ctrl+b to Ctrl+j
unbind C-b
set -g prefix C-j
bind C-j send-prefix

# Add reload binding
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# More intuitive split bindings
bind v split-window -h -c '#{pane_current_path}'  # Horizontal split (creates vertical line)
bind s split-window -v -c '#{pane_current_path}'  # Vertical split (creates horizontal line)

# Alternative split bindings
bind | split-window -h -c '#{pane_current_path}'
bind - split-window -v -c '#{pane_current_path}'

# Keep default % and " but have them open in current directory
bind % split-window -h -c '#{pane_current_path}'
bind '"' split-window -v -c '#{pane_current_path}'

# Easier pane navigation (vim-style)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Easier pane resizing
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Quick pane cycling
bind -r Tab select-pane -t :.+

# Synchronize panes toggle (useful for parallel operations)
bind S setw synchronize-panes \; display "Sync: #{?synchronize-panes,ON,OFF}"

# =============================================================================
# COPY MODE (VI BINDINGS)
# =============================================================================

# Use vi keys in copy mode
setw -g mode-keys vi

# Setup copy mode to work with macOS clipboard
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "pbcopy"
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# Enter copy mode with Prefix+[, paste with Prefix+]
# These are defaults but listed for clarity

# =============================================================================
# MACOS-SPECIFIC SETTINGS
# =============================================================================

# Fix macOS clipboard integration (if needed)
# Uncomment if clipboard doesn't work:
# set-option -g default-command "reattach-to-user-namespace -l ${SHELL}"

# =============================================================================
# LOAD SEMA THEME
# =============================================================================

source-file ~/.tmux/tmux-sema-theme.conf

# =============================================================================
# PLUGIN CONFIGURATION (Optional)
# =============================================================================

# List of plugins (requires TPM - Tmux Plugin Manager)
# To install TPM:
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# Uncomment these lines if you want to use plugins:
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'
# set -g @plugin 'tmux-plugins/tmux-resurrect'
# set -g @plugin 'tmux-plugins/tmux-continuum'
# set -g @plugin 'tmux-plugins/tmux-yank'
# set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# Plugin settings
# set -g @continuum-restore 'on'
# set -g @continuum-save-interval '15'
# set -g @resurrect-capture-pane-contents 'on'

# Initialize TPM (keep this line at the very bottom of tmux.conf)
# run '~/.tmux/plugins/tpm/tpm'

# =============================================================================
# SESSION INITIALIZATION HOOKS (Optional)
# =============================================================================

# Create a default session layout when tmux starts
# Uncomment and modify as needed:

# new-session -s main -n editor -d
# send-keys -t main:editor 'cd ~/projects' C-m
# split-window -t main:editor -h -p 30
# send-keys -t main:editor.2 'cd ~/projects' C-m
# select-pane -t main:editor.1

# =============================================================================
# NOTES FOR USAGE
# =============================================================================

# Quick command reference (all use Ctrl+j prefix unless noted):
# 
# Sessions:
#   new -s name     Create new session
#   ls              List sessions  
#   a -t name       Attach to session
#   d               Detach from session
#   $               Rename session
#
# Windows:
#   c               Create window
#   n/p             Next/Previous window
#   0-9             Go to window number
#   ,               Rename window
#   &               Kill window
#
# Panes:
#   |/-             Split vertical/horizontal (custom)
#   %/"             Split vertical/horizontal (default)
#   h/j/k/l         Navigate panes (custom)
#   H/J/K/L         Resize panes (custom)
#   z               Zoom/unzoom pane
#   x               Kill pane
#   S               Synchronize panes (custom)
#   {/}             Move pane left/right
#
# Copy Mode:
#   [               Enter copy mode
#   v               Begin selection (in copy mode)
#   y               Copy selection to clipboard
#   ]               Paste from tmux buffer
#
# Other:
#   r               Reload config (custom)
#   ?               List all key bindings
#   :               Command prompt